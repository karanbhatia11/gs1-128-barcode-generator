<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>GS1 Excel Parser (Debug)</title>

<!-- SheetJS (Cloudflare CDN – GitHub Pages safe) -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

<style>
body {
  font-family: Arial, sans-serif;
  padding: 30px;
  background: #f7f7f7;
}
.box {
  background: white;
  padding: 20px;
  max-width: 800px;
  border-radius: 6px;
}
pre {
  background: #111;
  color: #0f0;
  padding: 15px;
  overflow: auto;
}
</style>
</head>

<body>

<div class="box">
  <h2>GS1 Excel Parser (Debug Page)</h2>

  <input type="file" id="excelFile" accept=".xlsx">
  <br><br>

  <button onclick="parseExcel()">Parse Excel</button>

  <h3>Status</h3>
  <div id="status">Waiting…</div>

  <h3>Parsed Output</h3>
  <pre id="output"></pre>
</div>

<script>
function parseExcel() {
  const fileInput = document.getElementById("excelFile");
  const status = document.getElementById("status");
  const output = document.getElementById("output");

  if (!fileInput.files.length) {
    status.innerText = "❌ No file selected";
    return;
  }

  const reader = new FileReader();

  reader.onload = e => {
    try {
      const workbook = XLSX.read(e.target.result, {
        type: "binary",
        cellDates: true
      });

      const sheet = workbook.Sheets[workbook.SheetNames[0]];
      const rows = XLSX.utils.sheet_to_json(sheet);

      status.innerText = `✅ Parsed ${rows.length} rows`;
      output.textContent = JSON.stringify(rows, null, 2);

    } catch (err) {
      status.innerText = "❌ Error parsing Excel";
      output.textContent = err.message;
    }
  };

  reader.readAsBinaryString(fileInput.files[0]);
}
</script>

</body>
</html>
