<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title></title>

<script src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.6/dist/JsBarcode.all.min.js"></script>

<style>
/* ===== PRINT ===== */
@page {
  size: A4 landscape;
  margin: 0;
}

body {
  margin: 0;
  font-family: Arial, Helvetica, sans-serif;
  background: #ffffff;
  color: #111;
}

/* ===== TOOL UI ===== */
.controls {
  padding: 20px;
}
.controls label { display:block; margin-top:10px; }
.controls input { width:260px; padding:6px; }
.controls button { margin-top:15px; padding:8px 16px; }

@media print {
  .controls { display: none; }
}

/* ===== PAGE ===== */
.page {
  width: 100vw;
  height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
}

/* ===== CANVAS ===== */
.canvas {
  width: 88%;
}

/* ===== HEADER ===== */
.header {
  display: grid;
  grid-template-columns: 1fr auto 1fr;
  align-items: center;
  margin-bottom: 10mm;
  justify-content: end;
}

/* left spacer keeps logo truly centered */
.header .spacer {
  height: 1px;
}

.header img {
  height: 32px;
}
/* left spacer keeps logo truly centered */
.header .spacer {
  height: 1px;
}

.header img {
  height: 32px;
}

/* ===== META (TOP LEFT) ===== */
.meta {
  margin-bottom: 12mm;
}

.meta div {
  font-size: 18px;
  font-weight: 700;
  margin-bottom: 3mm;
}

/* ===== BARCODES (STACKED) ===== */
.barcode-section {
  margin-bottom: 16mm;
}

.barcode-title {
  font-size: 16px;
  font-weight: 700;
  margin-bottom: 4mm;
}

svg {
  width: 100%;
}
</style>
</head>

<body>

<!-- ===== TOOL ===== -->
<div class="controls">
  <h2>GS1-128 Barcode Generator</h2>

  <label>Item No (GTIN-14)</label>
  <input id="gtin" value="09421908260067">

  <label>Use By (DD.MM.YY)</label>
  <input id="expiry" value="01.05.28">

  <label>Batch / Lot</label>
  <input id="batch" value="055019">

  <label>Quantity</label>
  <input id="qty" value="40">

  <label>SSCC</label>
  <input id="sscc" value="012345600000001620">

  <br>
  <button onclick="generate()">Generate</button>
  <button onclick="window.print()">Download PDF</button>
</div>

<!-- ===== PDF ===== -->
<div class="page">
  <div class="canvas">

    <!-- HEADER -->
    <div class="header">
      <div class="spacer"></div>
      <img src="logo.svg" alt="Skutopia Logo">
      <div class="spacer"></div>
    </div>

    <!-- META (TOP LEFT) -->
    <div class="meta">
      <div id="itemText"></div>
      <div id="ssccText"></div>
    </div>

    <!-- BARCODE 1 -->
    <div class="barcode-section">
      <div class="barcode-title">BARCODE 1</div>
      <svg id="itemBarcode"></svg>
    </div>

    <!-- BARCODE 2 -->
    <div class="barcode-section">
      <div class="barcode-title">BARCODE 2</div>
      <svg id="ssccBarcode"></svg>
    </div>

  </div>
</div>

<script>
function generate() {
  itemBarcode.innerHTML = "";
  ssccBarcode.innerHTML = "";

  const gtin = document.getElementById("gtin").value;
  const [dd, mm, yy] = document.getElementById("expiry").value.split(".");
  const expiry = yy + mm + dd;
  const batch = document.getElementById("batch").value;
  const qty = document.getElementById("qty").value;
  const sscc = document.getElementById("sscc").value;

  /* 
  const itemGS1 =
    "(02)" + gtin +
    "(17)" + expiry +
    "(10)" + batch +
    "(37)" + qty;

  const ssccGS1 =
    "(00)" + sscc; 
  */

  // MACHINE-READABLE (scanner output)
  const itemGS1Encoded =
    "02" + gtin +
    "\\F17" + expiry +
    "\\F10" + batch +
    "\\F37" + qty;
  
  // HUMAN-READABLE (printed under barcode)
  const itemGS1Text =
    "(02)" + gtin +
    "(17)" + expiry +
    "(10)" + batch +
    "(37)" + qty;
  
  // SSCC (fixed length, no FNC1 needed)
  const ssccGS1Encoded = "00" + sscc;
  const ssccGS1Text = "(00)" + sscc;

  itemText.innerText = "ITEM NUMBER: " + gtin;
  ssccText.innerText = "SSCC: " + sscc;

  /*JsBarcode("#itemBarcode", itemGS1, {
    format: "CODE128",
    width: 1.5,
    height: 120,
    displayValue: true,
    fontSize: 26,
    textMargin: 8,
    margin: 0
  }); */

  JsBarcode("#itemBarcode", itemGS1Encoded, {
    format: "CODE128",
    displayValue: true,
    text: itemGS1Text,   // ðŸ‘ˆ key change
    width: 2.8,
    height: 120,
    fontSize: 26,
    textMargin: 8,
    margin: 0
  });

  /*JsBarcode("#ssccBarcode", ssccGS1, {
    format: "CODE128",
    width: 2.8,
    height: 120,
    displayValue: true,
    fontSize: 26,
    textMargin: 8,
    margin: 0
  });*/

  JsBarcode("#ssccBarcode", ssccGS1Encoded, {
    format: "CODE128",
    displayValue: true,
    text: ssccGS1Text,
    width: 2.8,
    height: 120,
    fontSize: 26,
    textMargin: 8,
    margin: 0
  });

}
</script>

</body>
</html>
